(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{9719:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c},dynamic:function(){return u}});var o=r(7437),s=r(2265),a=r(9376),n=r(575),l=r(8068),i=r(4226),d=r(1154);let u="force-dynamic";function c(){let{login:e,loading:t,error:r}=(0,n.a)(),u=(0,a.useRouter)(),[c,m]=(0,s.useState)(""),[h,v]=(0,s.useState)(""),[p,g]=(0,s.useState)(null),f=async t=>{t.preventDefault(),g(null);let r=await e(c,h);if(null==r?void 0:r.requiresOtp){let e=(null==r?void 0:r.email)?"lockout":"mfa";u.push("/verify-otp?email=".concat(encodeURIComponent(c),"&flow=").concat(e))}else(null==r?void 0:r.access_token)&&u.push("/dashboard")};return(0,o.jsxs)("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900",children:[(0,o.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,o.jsx)("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-blue-500/30 rounded-full blur-3xl animate-pulse"}),(0,o.jsx)("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-indigo-500/30 rounded-full blur-3xl animate-pulse delay-1000"}),(0,o.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-purple-500/20 rounded-full blur-3xl animate-pulse delay-500"})]}),(0,o.jsxs)("div",{className:"relative z-10 w-full max-w-md px-6",children:[(0,o.jsxs)("div",{className:"bg-white/10 backdrop-blur-2xl rounded-3xl shadow-2xl border border-white/20 p-8 md:p-10",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl mb-4 shadow-lg",children:(0,o.jsx)("span",{className:"text-3xl",children:"\uD83C\uDFE2"})}),(0,o.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),(0,o.jsx)("p",{className:"text-blue-200 text-sm",children:"Sign in to access your dashboard"})]}),(0,o.jsxs)("form",{onSubmit:f,className:"space-y-5",children:[(0,o.jsx)(l.Z,{type:"email",placeholder:"Email address",label:"Email",labelClassName:"block text-sm font-semibold text-white mb-2",value:c,onChange:e=>m(e.target.value),required:!0,icon:(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})}),className:"bg-white/90 backdrop-blur-sm"}),(0,o.jsx)(l.Z,{type:"password",placeholder:"Enter your password",label:"Password",labelClassName:"block text-sm font-semibold text-white mb-2",value:h,onChange:e=>v(e.target.value),required:!0,icon:(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),className:"bg-white/90 backdrop-blur-sm"}),(r||p)&&(0,o.jsx)("div",{className:"bg-red-500/20 backdrop-blur-sm border border-red-500/50 text-red-200 px-4 py-3 rounded-xl text-sm font-medium",children:r||p}),(0,o.jsx)(i.Z,{type:"submit",disabled:t,className:"w-full mt-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:t?(0,o.jsx)(d.Z,{}):(0,o.jsxs)("span",{className:"flex items-center justify-center space-x-2",children:[(0,o.jsx)("span",{children:"Sign In"}),(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})}),(0,o.jsx)("div",{className:"text-center mt-6",children:(0,o.jsxs)("a",{href:"/forgot-password",className:"text-blue-300 hover:text-blue-100 text-sm font-medium transition-colors duration-200 inline-flex items-center space-x-1 group",children:[(0,o.jsx)("span",{children:"Forgot your password?"}),(0,o.jsx)("svg",{className:"w-4 h-4 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]}),(0,o.jsx)("p",{className:"text-center text-blue-200 text-sm mt-6",children:"\xa9 2024 Company Portal. All rights reserved."})]})]})}},4226:function(e,t,r){"use strict";var o=r(7437);r(2265),t.Z=e=>{let{className:t="",variant:r="primary",children:s,...a}=e;return(0,o.jsx)("button",{className:"\n        ".concat({primary:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg shadow-blue-500/50 hover:shadow-blue-600/50",secondary:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white shadow-lg shadow-gray-500/50",danger:"bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white shadow-lg shadow-red-500/50",success:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg shadow-green-500/50",outline:"bg-transparent border-2 border-blue-600 text-blue-600 hover:bg-blue-50 shadow-none"}[r],"\n        rounded-xl px-6 py-3 w-full font-semibold\n        transition-all duration-300 \n        transform hover:scale-[1.02] active:scale-[0.98]\n        disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\n        focus:outline-none focus:ring-4 focus:ring-blue-500/50\n        ").concat(t,"\n      "),...a,children:s})}},8068:function(e,t,r){"use strict";var o=r(7437);r(2265),t.Z=e=>{let{className:t="",label:r,error:s,icon:a,labelClassName:n,...l}=e;return(0,o.jsxs)("div",{className:"w-full",children:[r&&(0,o.jsx)("label",{className:n||"block text-sm font-semibold text-gray-700 mb-2",children:r}),(0,o.jsxs)("div",{className:"relative",children:[a&&(0,o.jsx)("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",children:a}),(0,o.jsx)("input",{className:"\n            bg-white border-2 border-gray-200 text-gray-900 \n            rounded-xl px-4 py-3 w-full\n            ".concat(a?"pl-12":"","\n            focus:outline-none focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20\n            hover:border-gray-300\n            transition-all duration-300\n            placeholder:text-gray-400\n            disabled:bg-gray-50 disabled:cursor-not-allowed\n            ").concat(s?"border-red-500 focus:border-red-500 focus:ring-red-500/20":"","\n            ").concat(t,"\n          "),...l})]}),s&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600 font-medium",children:s})]})}},1154:function(e,t,r){"use strict";var o=r(7437);r(2265),t.Z=function(){return(0,o.jsx)("div",{className:"flex justify-center items-center",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-500"})})}},575:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return d}});var o=r(7437),s=r(2265),a=r(9116),n=r(9376);let l=(0,s.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[c,m]=(0,s.useState)(!1),[h,v]=(0,s.useState)(null),p=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&i(e),t&&u(JSON.parse(t))},[]);let g=async(e,t)=>{m(!0),v(null);let r=e.trim();try{let e=await a.Z.post("/auth/login",{email:r,password:t});if(e.data.requiresOtp)return{requiresOtp:!0};if(e.data.access_token&&e.data.user)return i(e.data.access_token),u(e.data.user),localStorage.setItem("token",e.data.access_token),localStorage.setItem("user",JSON.stringify(e.data.user)),{access_token:e.data.access_token,user:e.data.user};return v("Invalid response from server."),{}}catch(e){var o,s,n,l,d,c,h,p,g,f,b,x;if(console.log("[Auth] Login error status:",null===(o=e.response)||void 0===o?void 0:o.status),console.log("[Auth] Login error data:",null===(s=e.response)||void 0===s?void 0:s.data),(null===(l=e.response)||void 0===l?void 0:null===(n=l.data)||void 0===n?void 0:n.locked)===!0&&(null===(c=e.response)||void 0===c?void 0:null===(d=c.data)||void 0===d?void 0:d.email))return console.log("[Auth] OTP required (account locked)"),{requiresOtp:!0,email:e.response.data.email};if((null===(p=e.response)||void 0===p?void 0:null===(h=p.data)||void 0===h?void 0:h.suspended)===!0)return v((null===(x=e.response)||void 0===x?void 0:null===(b=x.data)||void 0===b?void 0:b.message)||"Your account has been suspended. Please contact an administrator."),{};return v((null===(f=e.response)||void 0===f?void 0:null===(g=f.data)||void 0===g?void 0:g.message)||"Login failed"),{}}finally{m(!1)}},f=async e=>{m(!0),v(null),console.log("[Auth] Requesting OTP for forgot password:",e);try{let t=await a.Z.post("/auth/forgot-password",{email:e});return console.log("[Auth] Forgot password response:",t.data),!0}catch(e){var t,r;return v((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Failed to request password reset OTP"),console.error("[Auth] Forgot password error:",e),!1}finally{m(!1)}},b=async(e,t)=>{m(!0),v(null),console.log("[Auth] Attempting OTP verification for email:",e);try{let r=await a.Z.post("/auth/verify-otp",{email:e,otp:t});if(console.log("[Auth] Response from /auth/verify-otp:",r.data),r.data.otp_reset)return console.log("[Auth] OTP verified, got otp_reset:",r.data.otp_reset),{otp_reset:r.data.otp_reset,type:"reset"};if(r.data.access_token&&r.data.user)return i(r.data.access_token),u(r.data.user),localStorage.setItem("token",r.data.access_token),localStorage.setItem("user",JSON.stringify(r.data.user)),{access_token:r.data.access_token,user:r.data.user,type:"mfa"};return v("Invalid OTP or response."),!1}catch(e){var r,o;return v((null===(o=e.response)||void 0===o?void 0:null===(r=o.data)||void 0===r?void 0:r.message)||"OTP verification failed"),!1}finally{m(!1)}},x=async(e,t,r,o)=>{m(!0),v(null);try{let s=await a.Z.post("/auth/reset-password",{email:e,otp_reset:t,newPassword:r,confirmPassword:o});return console.log("[Auth] Password reset response:",s.data),!0}catch(e){var s,n;return v((null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"Password reset failed"),console.error("[Auth] Password reset error:",e),!1}finally{m(!1)}};return(0,o.jsx)(l.Provider,{value:{token:r,user:d,loading:c,error:h,login:g,forgotPassword:f,verifyOtp:b,logout:()=>{console.log("[Auth] Logging out user"),i(null),u(null),localStorage.removeItem("token"),localStorage.removeItem("user"),p.push("/login")},resetPassword:x},children:t})},d=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9116:function(e,t,r){"use strict";let o=r(3464).Z.create({baseURL:"http://47.128.68.111:3000",withCredentials:!0,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{try{let t=localStorage.getItem("token");t&&e.headers&&(e.headers.Authorization="Bearer ".concat(t))}catch(e){console.warn("[API] Failed to read token from localStorage:",e)}return e}),o.interceptors.response.use(e=>e,e=>Promise.reject(e)),t.Z=o}},function(e){e.O(0,[301,971,117,744],function(){return e(e.s=9719)}),_N_E=e.O()}]);