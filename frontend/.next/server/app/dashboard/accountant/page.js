(()=>{var e={};e.id=836,e.ids=[836],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},5240:e=>{"use strict";e.exports=require("https")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},314:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),s(6786),s(3192),s(5866);var a=s(3191),r=s(8716),n=s(7922),i=s.n(n),o=s(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let d=["",{children:["dashboard",{children:["accountant",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6786)),"/home/ubuntu/fyp/frontend/app/dashboard/accountant/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3192)),"/home/ubuntu/fyp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/ubuntu/fyp/frontend/app/dashboard/accountant/page.tsx"],u="/dashboard/accountant/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/accountant/page",pathname:"/dashboard/accountant",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7845:(e,t,s)=>{Promise.resolve().then(s.bind(s,7682))},7682:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u,dynamic:()=>c});var a=s(326),r=s(7577),n=s(732),i=s(6824),o=s(3679),l=s(2186),d=s(5047);let c="force-dynamic";function u(){let{user:e,token:t,logout:s}=(0,n.a)(),c=(0,d.useRouter)(),[u,p]=(0,r.useState)([]),[m,h]=(0,r.useState)(null),[x,f]=(0,r.useState)(!1),[g,b]=(0,r.useState)(null),y=e?.role==="accountant"||e?.role==="super_admin",v=async e=>{if(e.type&&"application/octet-stream"!==e.type)return e.type.startsWith("text/")||"application/xml"===e.type||"application/json"===e.type;if(e.name&&e.name.toLowerCase().endsWith(".txt"))return!0;let t=e.slice(0,Math.min(4096,e.size)),s=new Uint8Array(await t.arrayBuffer()),a=0;for(let e=0;e<s.length;e++){let t=s[e];if(9!==t&&10!==t&&13!==t&&(!(t>=32)||!(t<=126))&&++a>.1*s.length)return!1}return!0},w=async()=>{if(!m){b("Please choose a file first");return}if(b(null),m.size>10485760){b("File too large");return}let e=m.type&&(["application/pdf","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"].includes(m.type)||m.type.startsWith("text/"))||""===m.type&&m.name.toLowerCase().endsWith(".txt")||"application/octet-stream"===m.type&&m.name.toLowerCase().endsWith(".txt"),t=!1;try{t=await v(m)}catch(e){t=!1,console.error("[Upload] text heuristic failed",e)}if(!(e||t)){b("Unsupported file type");return}f(!0);let a=new FormData;a.append("file",m);try{await i.Z.post("/accountant-files/upload",a,{headers:{"Content-Type":"multipart/form-data"},timeout:12e4}),b("Upload successful"),h(null);let e=await i.Z.get("/accountant-files");p(e.data.files||[])}catch(e){b(e.response?.data?.message||"Upload failed"),(e.response?.status===401||e.response?.status===403)&&s()}finally{f(!1);let e=document.querySelector("input[type=file]");e&&(e.value="")}},j=async(e,t)=>{try{let s=await i.Z.get(`/accountant-files/${e}`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([s.data])),r=document.createElement("a");r.href=a,r.download=t,r.click(),window.URL.revokeObjectURL(a)}catch(e){b(e.response?.data?.message||"Download failed"),(e.response?.status===401||e.response?.status===403)&&s()}},N=async(e,t)=>{if(confirm(`Are you sure you want to delete "${t}"?`))try{await i.Z.delete(`/accountant-files/${e}`),b("File deleted successfully");let t=await i.Z.get("/accountant-files");p(t.data.files||[])}catch(e){b(e.response?.data?.message||"Delete failed"),(e.response?.status===401||e.response?.status===403)&&s()}};return y?(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[e?.role==="super_admin"&&a.jsx(o.Z,{onClick:()=>c.push("/dashboard/superadmin"),className:"bg-gray-200 text-black hover:bg-gray-300 w-auto px-3 py-1",children:"Back"}),a.jsx("h1",{className:"text-2xl font-bold",children:"Accountant Dashboard"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("label",{className:"cursor-pointer bg-white border rounded px-3 py-2",children:[a.jsx("input",{type:"file",className:"hidden",onChange:e=>{let t=e.target.files?.[0]||null;b(null),h(t)}}),a.jsx("span",{className:"text-sm",children:"Choose File"})]}),a.jsx(o.Z,{onClick:w,disabled:x||!m,children:x?(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[a.jsx(l.Z,{}),"Scanning file..."]}):"Upload"})]})]}),m&&(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Selected: ",m.name," (",(m.size/1024).toFixed(1)," KB)"]}),g&&a.jsx("div",{className:"text-sm text-gray-700",children:g}),(0,a.jsxs)("div",{className:"border rounded",children:[(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-4 p-3 font-semibold bg-gray-50",children:[a.jsx("div",{children:"Filename"}),a.jsx("div",{children:"Type"}),a.jsx("div",{children:"Size"}),a.jsx("div",{children:"Uploaded By"}),a.jsx("div",{children:"Action"})]}),u.map(e=>(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-4 p-3 border-t",children:[a.jsx("div",{children:e.filename}),a.jsx("div",{className:"text-xs text-gray-600",children:e.mimetype}),(0,a.jsxs)("div",{className:"text-xs",children:[(e.size/1024).toFixed(1)," KB"]}),a.jsx("div",{className:"text-xs",children:e.uploaded_by?.email||"Unknown"}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(o.Z,{onClick:()=>j(e.id,e.filename),disabled:x,children:"Download"}),a.jsx(o.Z,{onClick:()=>N(e.id,e.filename),disabled:x,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})})]},e.id)),0===u.length&&a.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No files uploaded yet."})]})]}):(0,a.jsxs)("div",{className:"p-6",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Unauthorized"}),a.jsx("p",{className:"text-gray-600",children:"You do not have access to the Accountant dashboard."})]})}},3679:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(326);s(7577);let r=({className:e="",variant:t="primary",children:s,...r})=>a.jsx("button",{className:`
        ${{primary:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg shadow-blue-500/50 hover:shadow-blue-600/50",secondary:"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white shadow-lg shadow-gray-500/50",danger:"bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white shadow-lg shadow-red-500/50",success:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white shadow-lg shadow-green-500/50",outline:"bg-transparent border-2 border-blue-600 text-blue-600 hover:bg-blue-50 shadow-none"}[t]}
        rounded-xl px-6 py-3 w-full font-semibold
        transition-all duration-300 
        transform hover:scale-[1.02] active:scale-[0.98]
        disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
        focus:outline-none focus:ring-4 focus:ring-blue-500/50
        ${e}
      `,...r,children:s})},2186:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(326);s(7577);let r=function(){return a.jsx("div",{className:"flex justify-center items-center",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-500"})})}},6786:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,dynamic:()=>r});var a=s(8570);let r=(0,a.createProxy)(String.raw`/home/ubuntu/fyp/frontend/app/dashboard/accountant/page.tsx#dynamic`),n=(0,a.createProxy)(String.raw`/home/ubuntu/fyp/frontend/app/dashboard/accountant/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[229,317],()=>s(314));module.exports=a})();